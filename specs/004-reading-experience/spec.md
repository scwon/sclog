# Feature Specification: 블로그 읽기 경험 개선

**Feature Branch**: `004-reading-experience`
**Created**: 2025-12-07
**Status**: Draft
**Input**: 블로그 읽기 경험 개선 - 필수 기능 5개 추가

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 읽기 시간 확인 (Priority: P1)

독자가 블로그 글 페이지에 들어갔을 때, 글을 다 읽는 데 걸리는 예상 시간을 즉시 확인할 수 있다. 이를 통해 지금 읽을지, 나중에 읽을지 결정할 수 있다.

**Why this priority**: 가장 기본적인 정보 제공 기능으로, 다른 기능들과 독립적이며 구현이 간단하면서도 사용자 경험에 즉각적인 가치를 제공한다.

**Independent Test**: 아무 블로그 글에 접속하여 "N분 읽기" 형태의 텍스트가 표시되는지 확인

**Acceptance Scenarios**:

1. **Given** 본문이 1000자인 글, **When** 독자가 글 페이지에 접속하면, **Then** "2분 읽기"가 글 상단 메타 영역에 표시된다
2. **Given** 본문이 250자 미만인 짧은 글, **When** 독자가 글 페이지에 접속하면, **Then** "1분 미만" 또는 "1분 읽기"로 표시된다
3. **Given** 코드 블록이 포함된 글, **When** 읽기 시간 계산 시, **Then** 코드 블록도 본문에 포함하여 계산한다

---

### User Story 2 - 목차로 빠른 탐색 (Priority: P2)

독자가 긴 글을 읽을 때, 화면 측면에 고정된 목차를 통해 글의 전체 구조를 파악하고 원하는 섹션으로 즉시 이동할 수 있다. 현재 읽고 있는 섹션이 목차에서 강조 표시되어 위치를 쉽게 인식할 수 있다.

**Why this priority**: 긴 글의 탐색 편의성을 크게 높이는 핵심 기능이다. 읽기 시간과 함께 제공되면 독자가 글을 더 효율적으로 소비할 수 있다.

**Independent Test**: 헤딩이 3개 이상 있는 글에서 사이드 목차가 표시되고, 클릭 시 해당 섹션으로 이동하는지 확인

**Acceptance Scenarios**:

1. **Given** h2, h3 헤딩이 포함된 블로그 글, **When** 독자가 페이지를 열면, **Then** 화면 우측에 헤딩 목록이 표시된다
2. **Given** 목차가 표시된 상태, **When** 독자가 목차 항목을 클릭하면, **Then** 해당 섹션으로 부드럽게 스크롤 이동한다
3. **Given** 독자가 글을 스크롤하며 읽는 중, **When** 새로운 섹션에 진입하면, **Then** 목차에서 해당 섹션이 시각적으로 강조된다
4. **Given** 모바일 화면(768px 미만), **When** 독자가 페이지를 열면, **Then** 사이드 목차는 숨겨지거나 접근 가능한 대체 UI로 제공된다
5. **Given** 헤딩이 2개 이하인 짧은 글, **When** 독자가 페이지를 열면, **Then** 목차를 표시하지 않는다

---

### User Story 3 - 코드 쉽게 복사 (Priority: P3)

독자가 기술 블로그 글에서 코드 예제를 발견했을 때, 복사 버튼 한 번으로 코드를 클립보드에 복사할 수 있다. 코드 블록에는 어떤 언어인지 표시되어 있어 맥락을 쉽게 파악할 수 있다.

**Why this priority**: 기술 블로그의 핵심 가치인 코드 공유를 편리하게 만든다. 목차 다음으로 실용적인 가치가 높다.

**Independent Test**: 코드 블록이 있는 글에서 복사 버튼 클릭 시 코드가 클립보드에 복사되는지 확인

**Acceptance Scenarios**:

1. **Given** typescript로 표시된 코드 블록, **When** 독자가 코드 블록을 보면, **Then** 상단에 "typescript" 라벨이 표시된다
2. **Given** 코드 블록에 복사 버튼이 있음, **When** 독자가 복사 버튼을 클릭하면, **Then** 코드가 클립보드에 복사되고 "복사됨" 피드백이 표시된다
3. **Given** 복사 완료 후, **When** 2초가 경과하면, **Then** 버튼이 원래 상태(복사 아이콘)로 돌아간다
4. **Given** 언어가 지정되지 않은 코드 블록, **When** 독자가 코드 블록을 보면, **Then** 언어 라벨 없이 복사 버튼만 표시된다

---

### User Story 4 - 읽기 진행률 확인 (Priority: P4)

독자가 긴 글을 읽을 때, 페이지 상단에 고정된 진행률 바를 통해 얼마나 읽었는지 시각적으로 확인할 수 있다.

**Why this priority**: 읽기 동기 부여와 완독 유도에 효과적이다. 구현은 간단하지만 앞선 기능들보다 부가적인 성격이다.

**Independent Test**: 긴 글을 스크롤할 때 상단 진행률 바가 채워지는지 확인

**Acceptance Scenarios**:

1. **Given** 스크롤이 필요한 긴 글, **When** 페이지를 열면, **Then** 상단에 0% 상태의 진행률 바가 표시된다
2. **Given** 진행률 바가 표시된 상태, **When** 독자가 50% 지점까지 스크롤하면, **Then** 진행률 바가 50% 채워진다
3. **Given** 독자가 글 끝까지 스크롤, **When** 마지막 콘텐츠가 화면에 보이면, **Then** 진행률 바가 100%로 채워진다
4. **Given** 스크롤이 필요 없는 짧은 글, **When** 페이지를 열면, **Then** 진행률 바를 표시하지 않거나 100%로 표시한다

---

### User Story 5 - 맨 위로 빠른 이동 (Priority: P5)

독자가 긴 글을 끝까지 읽은 후, 맨 위로 버튼을 눌러 페이지 상단으로 빠르게 돌아갈 수 있다.

**Why this priority**: 가장 단순한 편의 기능으로, 다른 모든 기능이 구현된 후 마무리로 추가한다.

**Independent Test**: 페이지를 아래로 스크롤한 후 "맨 위로" 버튼이 나타나고 클릭 시 상단으로 이동하는지 확인

**Acceptance Scenarios**:

1. **Given** 페이지 최상단에 있는 상태, **When** 독자가 페이지를 열면, **Then** 맨 위로 버튼은 숨겨져 있다
2. **Given** 충분히 스크롤한 상태(300px 이상), **When** 독자가 스크롤하면, **Then** 맨 위로 버튼이 화면 우하단에 나타난다
3. **Given** 맨 위로 버튼이 표시된 상태, **When** 독자가 버튼을 클릭하면, **Then** 페이지가 부드럽게 최상단으로 스크롤된다
4. **Given** 맨 위로 이동 완료 후, **When** 스크롤 위치가 상단이면, **Then** 맨 위로 버튼이 다시 숨겨진다

---

### Edge Cases

- 본문 없이 제목만 있는 글에서 읽기 시간이 어떻게 표시되는가? → "1분 미만" 표시
- 목차 항목이 매우 긴 제목인 경우 → 말줄임(...) 처리
- 자바스크립트가 비활성화된 환경 → 복사 버튼, 진행률 바, 맨 위로 버튼은 동작하지 않지만 콘텐츠는 정상 표시
- 매우 빠른 스크롤 시 목차 하이라이트가 정확히 동작하는가? → 쓰로틀링/디바운스 적용
- 인쇄 시 → 진행률 바, 맨 위로 버튼은 인쇄되지 않음

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 시스템은 블로그 글 본문의 글자 수를 기반으로 읽기 시간을 계산해야 한다 (분당 500자 기준)
- **FR-002**: 시스템은 읽기 시간을 글 상단 메타 영역에 "N분 읽기" 형태로 표시해야 한다
- **FR-003**: 시스템은 글의 h2, h3 헤딩을 추출하여 목차를 생성해야 한다
- **FR-004**: 목차는 데스크톱에서 화면 우측에 고정(sticky) 표시되어야 한다
- **FR-005**: 스크롤 위치에 따라 현재 읽고 있는 섹션이 목차에서 강조 표시되어야 한다
- **FR-006**: 목차 항목 클릭 시 해당 섹션으로 부드러운 스크롤 이동이 되어야 한다
- **FR-007**: 코드 블록에 언어 라벨을 표시해야 한다 (마크다운에서 언어가 지정된 경우)
- **FR-008**: 코드 블록에 복사 버튼을 제공하고, 클릭 시 코드를 클립보드에 복사해야 한다
- **FR-009**: 복사 완료 시 시각적 피드백을 제공하고 2초 후 원래 상태로 복귀해야 한다
- **FR-010**: 페이지 상단에 스크롤 진행률을 나타내는 바를 고정 표시해야 한다
- **FR-011**: 진행률 바는 스크롤 위치에 따라 0%~100%로 채워져야 한다
- **FR-012**: 일정 거리(300px) 이상 스크롤 시 맨 위로 버튼을 표시해야 한다
- **FR-013**: 맨 위로 버튼 클릭 시 부드러운 애니메이션으로 페이지 최상단으로 이동해야 한다
- **FR-014**: 모바일(768px 미만)에서 사이드 목차는 숨기거나 대체 UI를 제공해야 한다

### Key Entities

- **ReadingMeta**: 읽기 시간, 글자 수 등 글의 메타 정보
- **TableOfContents**: 헤딩 목록, 각 헤딩의 ID와 레벨, 텍스트
- **ScrollState**: 현재 스크롤 위치, 진행률 퍼센트, 활성 섹션 ID

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 모든 블로그 글 페이지에서 읽기 시간이 1초 이내에 표시된다
- **SC-002**: 3개 이상의 헤딩이 있는 글에서 목차가 정상 표시된다
- **SC-003**: 목차 항목 클릭 시 0.5초 이내에 해당 섹션으로 스크롤 이동이 시작된다
- **SC-004**: 코드 복사 버튼 클릭 시 100% 성공적으로 클립보드에 복사된다
- **SC-005**: 스크롤 시 진행률 바가 실시간으로 업데이트된다 (60fps 유지)
- **SC-006**: 맨 위로 버튼이 스크롤 300px 이후 0.3초 이내에 나타난다
- **SC-007**: 모든 기능이 Chrome, Safari, Firefox 최신 버전에서 동일하게 동작한다
- **SC-008**: 모바일에서 목차 대체 UI가 제공되거나, 목차 없이도 다른 기능들이 정상 동작한다

## Assumptions

- 읽기 속도는 한글 기준 분당 500자로 가정한다 (일반적인 성인 읽기 속도)
- 코드 블록도 본문 글자 수에 포함하여 계산한다 (코드 읽기 시간도 필요)
- 목차는 h2, h3 레벨만 포함한다 (h4 이하는 너무 세부적)
- 헤딩이 2개 이하면 목차의 가치가 낮으므로 표시하지 않는다
- 맨 위로 버튼이 나타나는 스크롤 거리는 300px로 설정한다
- 진행률 바는 글 본문 영역 기준으로 계산한다 (헤더/푸터 제외)
